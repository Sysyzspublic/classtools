<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fusion://debugxweb</title>
    <style>
        .version-error {
            color: red;
        }

        .version-ok {
            color: black;
        }
    </style>
</head>

<body>
    <h1>DebugWeb</h1>
    <p>å¦‚æœæ‚¨åœ¨ä½¿ç”¨ ClassTools æ—¶å‡ºç°é—®é¢˜ï¼Œæ­¤é¡µé¢å°†å¸®åŠ©å¼€å‘äººå‘˜æ›´å¿«å®šä½ã€‚</p>

    <hr>

    <div id="user-agent-container">
        <h2>UserAgent</h2>
        <p color="red"><strong><span id="oops"></span></strong></p>
        <p>æ‚¨çš„æµè§ˆå™¨å†…æ ¸: <span id="browser-version">æ­£åœ¨æ£€æµ‹æµè§ˆå™¨ç‰ˆæœ¬...</span></p>
        <p>ç”¨æˆ·ä»£ç†å­—ç¬¦ä¸²: <span id="user-agent">æ­£åœ¨è·å–UserAgentâ€¦â€¦</span></p>
        <p id="language"></p>

        <hr>

        <h2>CSS / JS</h2>
        <ul>
            <li><span id="fetch"></span>Fetch</li> <!-- Fetch API -->
            <li><span id="arrow-function"></span>Arrow Functions</li> <!-- ç®­å¤´å‡½æ•° -->
            <li><span id="includes"></span>Array.prototype.includes</li>  <!-- Array.prototype.includes -->
            <li><span id="css-variables"></span>CSS Variables</li> <!-- æ ·å¼è¡¨å˜é‡ -->
            <li><span id="clipboard"></span>Clipboard API</li> <!-- å¼‚æ­¥å‰ªè´´æ¿ -->
            <li><span id="optional-chaining"></span>optional-chaining</li> <!-- å¯é€‰é“¾æ“ä½œç¬¦ -->
            <li><span id="flexbox-gap"></span>flexbox-gap</li> <!-- çµæ´»å¸ƒå±€é—´éš™ -->
            <li><span id="private-methods"></span>private-methods</li> <!-- ç§æœ‰ç±»æ–¹æ³• -->
            <li><span id="string-replace-global"></span>String Global Replace</li> <!-- å­—ç¬¦ä¸²å…¨å±€æ›¿æ¢ -->
        </ul>
    </div>

    <script>
        // è·å–æµè§ˆå™¨çš„ä»£ç†å­—ç¬¦ä¸²
        let userAgent = navigator.userAgent;

        // è·å–æ˜¾ç¤ºä»£ç†å­—ç¬¦ä¸²çš„div
        let userAgentDiv = document.getElementById('user-agent');

        // å°†ä»£ç†å­—ç¬¦ä¸²å¡«å…¥æŒ‡å®šdivä¸­
        userAgentDiv.textContent = userAgent;

        // è·å–æµè§ˆå™¨è¯­è¨€è®¾ç½®
        var language = navigator.language || navigator.languages[0];

        // æ˜¾ç¤ºè¯­è¨€
        document.getElementById('language').innerText = "æµè§ˆå™¨è¯­è¨€: " + language;

        // æ£€æµ‹æ˜¯å¦ä¸º Wechat
        if (userAgent.indexOf("Wechat") > -1) {
            document.getElementById('oops').textContent = "å¯¹æ­¤é¡µé¢ä¸ä¿¡ä»»ï¼Œè¯·è€å¸ˆåœ¨æµè§ˆå™¨ä¸Šä½¿ç”¨ ClassTools";
            document.getElementById('oops').style.color = "orange"; // ä¿®æ”¹æ–‡æœ¬é¢œè‰²ä¸ºæ©™è‰²
        }

        function getBrowserVersion() {
            var userAgent = navigator.userAgent;
            var version = "æœªçŸ¥ç‰ˆæœ¬";
            var versionColorClass = "version-ok"; // é»˜è®¤é»‘è‰²

            // æ£€æµ‹æ˜¯å¦ä¸º IE
            if (userAgent.indexOf("MSIE") > -1 || userAgent.indexOf("Trident/") > -1) {
                version = "æ‚¨çš„æµè§ˆå™¨ç‰ˆæœ¬è¿‡ä½";
                versionColorClass = "version-error";
            }
            // æ£€æµ‹æ˜¯å¦ä¸º Chromeï¼ˆåŒ…æ‹¬ Chromiumï¼‰
            else if (userAgent.indexOf("Chrome") > -1) {
                var versionMatch = userAgent.match(/Chrome\/([0-9]+)/);
                if (versionMatch) {
                    version = "è°·æ­Œ Chromium " + versionMatch[1];

                    // åˆ¤æ–­ç‰ˆæœ¬å·ï¼Œè‹¥å°äº132åˆ™è®¾ç½®ä¸ºçº¢è‰²
                    if (parseInt(versionMatch[1]) < 132) {
                        versionColorClass = "version-error";
                    }
                }
            }
            // æ£€æµ‹æ˜¯å¦ä¸º Edge
            else if (userAgent.indexOf("Edg") > -1) {
                var versionMatch = userAgent.match(/Edg\/([0-9]+)/);
                if (versionMatch) {
                    version = "å¾®è½¯ Edge " + versionMatch[1];

                    // åˆ¤æ–­ç‰ˆæœ¬å·ï¼Œè‹¥å°äº132åˆ™è®¾ç½®ä¸ºçº¢è‰²
                    if (parseInt(versionMatch[1]) < 132) {
                        versionColorClass = "version-error";
                    }
                }
            }
            // æ£€æµ‹æ˜¯å¦ä¸º Firefox
            else if (userAgent.indexOf("Firefox") > -1) {
                var versionMatch = userAgent.match(/Firefox\/([0-9]+)/);
                if (versionMatch) {
                    version = "Mozilla Firefox " + versionMatch[1];
                }
            }

            return { version: version, colorClass: versionColorClass };
        }

        var browserInfo = getBrowserVersion();
        document.getElementById("browser-version").textContent = browserInfo.version;
        document.getElementById("browser-version").classList.add(browserInfo.colorClass);

        // æ£€æŸ¥å„ä¸ªç‰¹æ€§
        function checkFeatureAvailability() {
            // Fetch API
            if (typeof fetch !== 'undefined') {
                document.getElementById('fetch').innerText = "âœ…";
            } else {
                document.getElementById('fetch').innerText = "ğŸ¤”";
            }

            // ç®­å¤´å‡½æ•°
            try {
                new Function('()=>{}');  // å°è¯•åˆ›å»ºç®­å¤´å‡½æ•°
                document.getElementById('arrow-function').innerText = "âœ…";
            } catch (e) {
                document.getElementById('arrow-function').innerText = "ğŸ¤”";
            }

            // Array.prototype.includes
            if (Array.prototype.includes) {
                document.getElementById('includes').innerText = "âœ…";
            } else {
                document.getElementById('includes').innerText = "ğŸ¤”";
            }

            // CSS å˜é‡æ”¯æŒ
            var testElement = document.createElement('div');
            testElement.style.setProperty('--test', '1px');
            if (testElement.style.getPropertyValue('--test') === '1px') {
                document.getElementById('css-variables').innerText = "âœ…";
            } else {
                document.getElementById('css-variables').innerText = "ğŸ¤”";
            }

            // å¼‚æ­¥å‰ªè´´æ¿æ”¯æŒ
            if (navigator.clipboard && typeof navigator.clipboard.writeText === 'function') {
                document.getElementById('clipboard').innerText = "âœ…";
            } else {
                document.getElementById('clipboard').innerText = "ğŸ¤”";
            }
        }

        // å¯é€‰é“¾æ“ä½œç¬¦æ£€æµ‹
        function checkOptionalChaining() {
            try {
                const obj = { foo: { bar: { baz: 42 } } };
                return obj?.foo?.bar?.baz ? 'âœ…' : 'ğŸ¤”';
            } catch (e) {
                return 'ğŸ¤”';
            }
        }

        // çµæ´»å¸ƒå±€é—´éš™æ£€æµ‹
        function checkFlexboxGap() {
            const div = document.createElement('div');
            div.style.display = 'flex';
            div.style.gap = '10px';
            return div.style.gap === '10px' ? 'âœ…' : 'ğŸ¤”';
        }

        // ç§æœ‰ç±»æ–¹æ³•æ£€æµ‹
        function checkPrivateMethods() {
            try {
                class MyClass {
                    #privateMethod() { return 'private'; }
                    test() { return this.#privateMethod(); }
                }
                const obj = new MyClass();
                obj.test(); // è®¿é—®ç§æœ‰æ–¹æ³•
                return 'âœ…';
            } catch (e) {
                return 'ğŸ¤”';
            }
        }

        // å­—ç¬¦ä¸²å…¨å±€æ›¿æ¢æ£€æµ‹
        function checkStringReplaceGlobal() {
            const str = 'hello world hello';
            const result = str.replace(/hello/g, 'hi');
            return result === 'hi world hi' ? 'âœ…' : 'ğŸ¤”';
        }

        // è°ƒç”¨å‡½æ•°æ£€æŸ¥æ”¯æŒ

        // å»¶è¿Ÿä¸€ç§’åŠæ˜¾ç¤ºæ‰€æœ‰ç‰¹æ€§çš„æ£€æµ‹ç»“æœ
        let delay = 1500; // åˆå§‹å»¶è¿Ÿæ—¶é—´ä¸º1.5ç§’

        setTimeout(() => {
            // Fetch API
            if (typeof fetch !== 'undefined') {
                document.getElementById('fetch').innerText = "âœ…";
            } else {
                document.getElementById('fetch').innerText = "ğŸ¤”";
            }
        }, delay);

        delay += 500; // æ¯ä¸ªç‰¹æ€§æ£€æµ‹ç»“æœå»¶è¿Ÿ500æ¯«ç§’æ˜¾ç¤º

        setTimeout(() => {
            // ç®­å¤´å‡½æ•°
            try {
                new Function('()=>{}');  // å°è¯•åˆ›å»ºç®­å¤´å‡½æ•°
                document.getElementById('arrow-function').innerText = "âœ…";
            } catch (e) {
                document.getElementById('arrow-function').innerText = "ğŸ¤”";
            }
        }, delay);

        delay += 500;

        setTimeout(() => {
            // Array.prototype.includes
            if (Array.prototype.includes) {
                document.getElementById('includes').innerText = "âœ…";
            } else {
                document.getElementById('includes').innerText = "ğŸ¤”";
            }
        }, delay);

        delay += 500;

        setTimeout(() => {
            // CSS å˜é‡æ”¯æŒ
            var testElement = document.createElement('div');
            testElement.style.setProperty('--test', '1px');
            if (testElement.style.getPropertyValue('--test') === '1px') {
                document.getElementById('css-variables').innerText = "âœ…";
            } else {
                document.getElementById('css-variables').innerText = "ğŸ¤”";
            }
        }, delay);

        delay += 500;

        setTimeout(() => {
            // å¼‚æ­¥å‰ªè´´æ¿æ”¯æŒ
            if (navigator.clipboard && typeof navigator.clipboard.writeText === 'function') {
                document.getElementById('clipboard').innerText = "âœ…";
            } else {
                document.getElementById('clipboard').innerText = "ğŸ¤”";
            }
        }, delay);

        delay += 500;

        setTimeout(() => {
            // å¯é€‰é“¾æ“ä½œç¬¦æ£€æµ‹
            document.getElementById('optional-chaining').textContent = checkOptionalChaining();
            document.getElementById('optional-chaining').classList.add(checkOptionalChaining() === 'âœ…' ? 'success' : 'error');
        }, delay);

        delay += 500;

        setTimeout(() => {
            // çµæ´»å¸ƒå±€é—´éš™æ£€æµ‹
            document.getElementById('flexbox-gap').textContent = checkFlexboxGap();
            document.getElementById('flexbox-gap').classList.add(checkFlexboxGap() === 'âœ…' ? 'success' : 'error');
        }, delay);

        delay += 500;

        setTimeout(() => {
            // ç§æœ‰ç±»æ–¹æ³•æ£€æµ‹
            document.getElementById('private-methods').textContent = checkPrivateMethods();
            document.getElementById('private-methods').classList.add(checkPrivateMethods() === 'âœ…' ? 'success' : 'error');
        }, delay);

        delay += 500;

        setTimeout(() => {
            // å­—ç¬¦ä¸²å…¨å±€æ›¿æ¢æ£€æµ‹
            document.getElementById('string-replace-global').textContent = checkStringReplaceGlobal();
            document.getElementById('string-replace-global').classList.add(checkStringReplaceGlobal() === 'âœ…' ? 'success' : 'error');
        }, delay);
    </script>

</body>

</html>
